{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\joha\\\\Desktop\\\\dcake1\\\\DreamCakeFront\\\\src\\\\components\\\\social\\\\social.jsx\";\nimport './style.scss';\nimport React from 'react';\nimport { Feed } from './feed';\nimport { CreatePost } from './createPost';\nimport Cookies from 'js-cookie';\nimport añadir from '../../static/images/anadir.png';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport class Social extends React.Component {\n  constructor() {\n    super();\n    this.ws = new WebSocket(\"ws://localhost:8000/ws/socialGeneral/\");\n    this.attrs = {\n      1: \"likes\",\n      2: \"published_date\"\n    };\n    this.order = {\n      asc: \"\",\n      desc: \"-\"\n    };\n    this.state = {\n      attr: this.attrs[2],\n      count: 20,\n      order: this.order.desc,\n      posts: []\n    };\n    this.update = this.update.bind(this);\n  }\n\n  componentDidMount() {\n    this.requestUser();\n    this.loadPosts();\n    /* this.ws.onopen = evt => this.send(); \r\n    this.ws.onclose = evt => window.location.reload(); \r\n    this.ws.onmessage = evt => this.loadPosts();\r\n    this.ws.onerror = evt => console.log(JSON.stringify(evt));  */\n  }\n\n  requestUser() {\n    fetch('http://localhost:8000/users/api/auth/user/', {\n      method: 'GET',\n      credentials: 'include',\n      headers: {}\n    }).then(response => response.json()).then(responseJson => {\n      if (!responseJson.hasOwnProperty('email')) window.location.pathname = \"/\";\n    }).catch(error => window.location.pathname = \"/\");\n  }\n\n  loadPosts() {\n    fetch(\"http://localhost:8000/social/all_posts/\" + this.state.order + this.state.attr + \"/\" + this.state.count + '/').then(response => response.json()).then(json => this.setState({\n      posts: json\n    })).catch(error => console.log(error));\n  }\n\n  update() {\n    this.loadPosts();\n  }\n\n  send() {\n    this.ws.send(JSON.stringify({\n      type: \"subscribe\",\n      id: new Date().getTime(),\n      action: 'list',\n      model: \"social.Post\"\n    }));\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"row justify-content-center\",\n        children: [/*#__PURE__*/_jsxDEV(CreatePost, {\n          update: this.update\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 87,\n          columnNumber: 6\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col-lg-6 col-sm-8 col-12\",\n          children: /*#__PURE__*/_jsxDEV(Feed, {\n            modificar: this.props.modificar,\n            posts: this.state.posts\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 90,\n            columnNumber: 7\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 89,\n          columnNumber: 6\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 5\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 4\n    }, this);\n  }\n\n}","map":{"version":3,"sources":["C:/Users/joha/Desktop/dcake1/DreamCakeFront/src/components/social/social.jsx"],"names":["React","Feed","CreatePost","Cookies","añadir","Social","Component","constructor","ws","WebSocket","attrs","order","asc","desc","state","attr","count","posts","update","bind","componentDidMount","requestUser","loadPosts","fetch","method","credentials","headers","then","response","json","responseJson","hasOwnProperty","window","location","pathname","catch","error","setState","console","log","send","JSON","stringify","type","id","Date","getTime","action","model","render","props","modificar"],"mappings":"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","sourcesContent":["import './style.scss';\r\nimport React from 'react';\r\nimport { Feed } from './feed';\r\nimport { CreatePost } from './createPost';\r\nimport Cookies from 'js-cookie';\r\nimport añadir from '../../static/images/anadir.png'\r\n\r\n\r\nexport class Social extends React.Component {\r\n\r\n\tws = new WebSocket(\"ws://localhost:8000/ws/socialGeneral/\")\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\tthis.attrs = {\r\n\t\t\t1: \"likes\",\r\n\t\t\t2: \"published_date\",\r\n\t\t}\r\n\r\n\t\tthis.order = {\r\n\t\t\tasc: \"\",\r\n\t\t\tdesc: \"-\"\r\n\t\t}\r\n\r\n\t\tthis.state = {\r\n\t\t\tattr: this.attrs[2],\r\n\t\t\tcount: 20,\r\n\t\t\torder: this.order.desc,\r\n\t\t\tposts: []\r\n\t\t};\r\n\r\n\t\tthis.update = this.update.bind(this)\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\tthis.requestUser();\r\n\t\tthis.loadPosts();\r\n\t\t\r\n\t\t/* this.ws.onopen = evt => this.send(); \r\n\t\tthis.ws.onclose = evt => window.location.reload(); \r\n\t\tthis.ws.onmessage = evt => this.loadPosts();\r\n\t\tthis.ws.onerror = evt => console.log(JSON.stringify(evt));  */\r\n\t}\r\n\r\n\trequestUser() {\r\n\t\tfetch('http://localhost:8000/users/api/auth/user/', {\r\n\t\t\tmethod: 'GET',\r\n\t\t\tcredentials: 'include',\r\n\t\t\theaders: {\r\n\t\t\t},\r\n\t\t}).then((response) => response.json())\r\n\t\t\t.then(responseJson => {\r\n\t\t\t\tif(!responseJson.hasOwnProperty('email')) window.location.pathname = \"/\";\r\n\t\t\t}).catch(error => window.location.pathname = \"/\");\r\n\t}\r\n\r\n\tloadPosts() {\r\n\t\tfetch(\"http://localhost:8000/social/all_posts/\" + this.state.order +this.state.attr + \"/\" + this.state.count+'/')\r\n\t\t\t.then(response => response.json())\r\n\t\t\t.then(json => this.setState({\r\n\t\t\t\tposts: json\r\n\t\t\t}))\r\n\t\t\t.catch(error => console.log(error));\r\n\t}\r\n\t\r\n\r\n\tupdate() {\r\n\t\tthis.loadPosts()\r\n\t}\r\n\r\n\tsend() {\r\n\t\tthis.ws.send(JSON.stringify({\r\n\t\t\ttype: \"subscribe\",\r\n\t\t\tid: new Date().getTime(),\r\n\t\t\taction: 'list',\r\n\t\t\tmodel: \"social.Post\"\r\n\t\t}))\r\n\t}\r\n\r\n\trender() {\r\n\r\n\t\treturn (\r\n\t\t\t<div className=\"container\">\r\n\t\t\t\t<div className=\"row justify-content-center\">\r\n\t\t\t\t\t\r\n\t\t\t\t\t<CreatePost update={this.update} />\r\n\t\t\t\t\t\r\n\t\t\t\t\t<div className=\"col-lg-6 col-sm-8 col-12\">\r\n\t\t\t\t\t\t<Feed modificar={this.props.modificar} posts={this.state.posts} />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\n\r\n\r\n\r\n"]},"metadata":{},"sourceType":"module"}