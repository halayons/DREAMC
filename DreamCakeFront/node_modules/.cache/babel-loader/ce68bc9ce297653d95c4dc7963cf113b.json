{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\joha\\\\Desktop\\\\dcake1\\\\DreamCakeFront\\\\src\\\\components\\\\social\\\\createPost.jsx\";\nimport './style.scss';\nimport React from 'react';\nimport Cookies from 'js-cookie';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport class CreatePost extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      pasteles: [],\n      file: '',\n      imagePreviewUrl: '',\n      option: ''\n    };\n    this.handleImageChange = this.handleImageChange.bind(this);\n    this.handleSelect = this.handleSelect.bind(this);\n    this.crearPost = this.crearPost.bind(this);\n  }\n\n  componentDidMount() {\n    this.getCakes();\n  }\n\n  crearPost(e) {\n    let form_data = new FormData();\n    form_data.append('foto', this.state.file);\n    form_data.append('likes', 0);\n    form_data.append('status', true);\n    form_data.append('reported', false);\n    form_data.append('pastel', this.state.option);\n    const requestOptions = {\n      method: 'POST',\n      headers: {\n        'X-CSRFToken': Cookies.get('csrftoken')\n      },\n      credentials: \"include\",\n      body: form_data\n    };\n    fetch('http://localhost:8000/social/create_post/', requestOptions).then(res => res.json()).then(json => {\n      this.props.update();\n      console.log('Post creado\\n' + json);\n    }).catch(error => console.log(error));\n  }\n\n  handleSelect(e) {\n    console.log(e);\n    this.setState({\n      option: e.target.value\n    });\n  }\n\n  handleImageChange(e) {\n    e.preventDefault();\n    let reader = new FileReader();\n    let file = e.target.files[0];\n\n    reader.onloadend = () => {\n      this.setState({\n        file: file,\n        imagePreviewUrl: reader.result\n      });\n    };\n\n    reader.readAsDataURL(file);\n  }\n\n  getCakes() {\n    const requestOptions = {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json',\n        'X-CSRFToken': Cookies.get('csrftoken')\n      },\n      credentials: \"include\"\n    };\n    fetch('http://localhost:8000/pasteles/', requestOptions).then(res => res.json()).then(json => {\n      this.setState({\n        pasteles: json,\n        option: json[0].id\n      });\n    }).catch(error => console.log(error));\n  }\n\n  render() {\n    let {\n      imagePreviewUrl\n    } = this.state;\n    let $imagePreview = null;\n\n    if (imagePreviewUrl) {\n      $imagePreview = /*#__PURE__*/_jsxDEV(\"img\", {\n        src: imagePreviewUrl\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 21\n      }, this);\n    } else {\n      $imagePreview = /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"previewText\",\n        children: \"Elige una imagen para el post\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 21\n      }, this);\n    }\n\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container\",\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        children: \"Crear Post\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 30\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        children: \"pastel: \"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n        value: this.state.option,\n        onChange: this.handleSelect,\n        children: this.state.pasteles.map(pastel => /*#__PURE__*/_jsxDEV(\"option\", {\n          value: pastel.id,\n          children: pastel.id\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 112,\n          columnNumber: 8\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        class: \"foto\",\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"file\",\n          onChange: this.handleImageChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 117,\n          columnNumber: 6\n        }, this), $imagePreview]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: this.crearPost,\n        children: \"crear\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 5\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 4\n    }, this);\n  }\n\n}","map":{"version":3,"sources":["C:/Users/joha/Desktop/dcake1/DreamCakeFront/src/components/social/createPost.jsx"],"names":["React","Cookies","CreatePost","Component","constructor","props","state","pasteles","file","imagePreviewUrl","option","handleImageChange","bind","handleSelect","crearPost","componentDidMount","getCakes","e","form_data","FormData","append","requestOptions","method","headers","get","credentials","body","fetch","then","res","json","update","console","log","catch","error","setState","target","value","preventDefault","reader","FileReader","files","onloadend","result","readAsDataURL","id","render","$imagePreview","map","pastel"],"mappings":";AAAA,OAAO,cAAP;AACA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,OAAP,MAAoB,WAApB;;AAEA,OAAO,MAAMC,UAAN,SAAyBF,KAAK,CAACG,SAA/B,CAAyC;AAE/CC,EAAAA,WAAW,CAACC,KAAD,EAAQ;AAClB,UAAMA,KAAN;AACA,SAAKC,KAAL,GAAa;AACZC,MAAAA,QAAQ,EAAE,EADE;AAEZC,MAAAA,IAAI,EAAE,EAFM;AAGZC,MAAAA,eAAe,EAAE,EAHL;AAIZC,MAAAA,MAAM,EAAE;AAJI,KAAb;AAOA,SAAKC,iBAAL,GAAyB,KAAKA,iBAAL,CAAuBC,IAAvB,CAA4B,IAA5B,CAAzB;AACA,SAAKC,YAAL,GAAoB,KAAKA,YAAL,CAAkBD,IAAlB,CAAuB,IAAvB,CAApB;AACA,SAAKE,SAAL,GAAiB,KAAKA,SAAL,CAAeF,IAAf,CAAoB,IAApB,CAAjB;AACA;;AAEDG,EAAAA,iBAAiB,GAAG;AACnB,SAAKC,QAAL;AACA;;AAEDF,EAAAA,SAAS,CAACG,CAAD,EAAI;AACZ,QAAIC,SAAS,GAAG,IAAIC,QAAJ,EAAhB;AACAD,IAAAA,SAAS,CAACE,MAAV,CAAiB,MAAjB,EAAyB,KAAKd,KAAL,CAAWE,IAApC;AACAU,IAAAA,SAAS,CAACE,MAAV,CAAiB,OAAjB,EAA0B,CAA1B;AACAF,IAAAA,SAAS,CAACE,MAAV,CAAiB,QAAjB,EAA2B,IAA3B;AACAF,IAAAA,SAAS,CAACE,MAAV,CAAiB,UAAjB,EAA6B,KAA7B;AACAF,IAAAA,SAAS,CAACE,MAAV,CAAiB,QAAjB,EAA2B,KAAKd,KAAL,CAAWI,MAAtC;AAEA,UAAMW,cAAc,GAAG;AACbC,MAAAA,MAAM,EAAE,MADK;AAEbC,MAAAA,OAAO,EAAE;AACjB,uBAActB,OAAO,CAACuB,GAAR,CAAY,WAAZ;AADG,OAFI;AAKbC,MAAAA,WAAW,EAAE,SALA;AAMbC,MAAAA,IAAI,EAAER;AANO,KAAvB;AASAS,IAAAA,KAAK,CAAC,2CAAD,EAA8CN,cAA9C,CAAL,CACOO,IADP,CACYC,GAAG,IAAIA,GAAG,CAACC,IAAJ,EADnB,EAEOF,IAFP,CAEYE,IAAI,IAAI;AACnB,WAAKzB,KAAL,CAAW0B,MAAX;AACAC,MAAAA,OAAO,CAACC,GAAR,CAAY,kBAAkBH,IAA9B;AACM,KALP,EAMOI,KANP,CAMaC,KAAK,IAAIH,OAAO,CAACC,GAAR,CAAYE,KAAZ,CANtB;AAOA;;AAEDtB,EAAAA,YAAY,CAACI,CAAD,EAAI;AACfe,IAAAA,OAAO,CAACC,GAAR,CAAYhB,CAAZ;AACM,SAAKmB,QAAL,CAAc;AACV1B,MAAAA,MAAM,EAAEO,CAAC,CAACoB,MAAF,CAASC;AADP,KAAd;AAGH;;AAEJ3B,EAAAA,iBAAiB,CAACM,CAAD,EAAI;AACpBA,IAAAA,CAAC,CAACsB,cAAF;AAEA,QAAIC,MAAM,GAAG,IAAIC,UAAJ,EAAb;AACA,QAAIjC,IAAI,GAAGS,CAAC,CAACoB,MAAF,CAASK,KAAT,CAAe,CAAf,CAAX;;AAEAF,IAAAA,MAAM,CAACG,SAAP,GAAmB,MAAM;AACxB,WAAKP,QAAL,CAAc;AACb5B,QAAAA,IAAI,EAAEA,IADO;AAEbC,QAAAA,eAAe,EAAE+B,MAAM,CAACI;AAFX,OAAd;AAIA,KALD;;AAOAJ,IAAAA,MAAM,CAACK,aAAP,CAAqBrC,IAArB;AACA;;AAEDQ,EAAAA,QAAQ,GAAG;AACV,UAAMK,cAAc,GAAG;AACtBC,MAAAA,MAAM,EAAE,KADc;AAEtBC,MAAAA,OAAO,EAAE;AACR,wBAAgB,kBADR;AAER,uBAAetB,OAAO,CAACuB,GAAR,CAAY,WAAZ;AAFP,OAFa;AAMtBC,MAAAA,WAAW,EAAE;AANS,KAAvB;AASAE,IAAAA,KAAK,CAAC,iCAAD,EAAoCN,cAApC,CAAL,CACEO,IADF,CACOC,GAAG,IAAIA,GAAG,CAACC,IAAJ,EADd,EAEEF,IAFF,CAEOE,IAAI,IAAI;AACb,WAAKM,QAAL,CAAc;AACb7B,QAAAA,QAAQ,EAAEuB,IADG;AAEbpB,QAAAA,MAAM,EAAEoB,IAAI,CAAC,CAAD,CAAJ,CAAQgB;AAFH,OAAd;AAIA,KAPF,EAQEZ,KARF,CAQQC,KAAK,IAAIH,OAAO,CAACC,GAAR,CAAYE,KAAZ,CARjB;AASA;;AAEDY,EAAAA,MAAM,GAAG;AAER,QAAI;AAAEtC,MAAAA;AAAF,QAAsB,KAAKH,KAA/B;AACA,QAAI0C,aAAa,GAAG,IAApB;;AACA,QAAIvC,eAAJ,EAAqB;AACpBuC,MAAAA,aAAa,gBAAI;AAAK,QAAA,GAAG,EAAEvC;AAAV;AAAA;AAAA;AAAA;AAAA,cAAjB;AACA,KAFD,MAEO;AACNuC,MAAAA,aAAa,gBAAI;AAAK,QAAA,SAAS,EAAC,aAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAAjB;AACA;;AAED,wBACC;AAAK,MAAA,SAAS,EAAC,WAAf;AAAA,8BACC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cADD,eAC0B;AAAA;AAAA;AAAA;AAAA,cAD1B,eAEC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAFD,eAGC;AAAQ,QAAA,KAAK,EAAE,KAAK1C,KAAL,CAAWI,MAA1B;AAAkC,QAAA,QAAQ,EAAI,KAAKG,YAAnD;AAAA,kBAEE,KAAKP,KAAL,CAAWC,QAAX,CAAoB0C,GAApB,CAAwBC,MAAM,iBAC7B;AAAQ,UAAA,KAAK,EAAEA,MAAM,CAACJ,EAAtB;AAAA,oBAA2BI,MAAM,CAACJ;AAAlC;AAAA;AAAA;AAAA;AAAA,gBADD;AAFF;AAAA;AAAA;AAAA;AAAA,cAHD,eAUC;AAAK,QAAA,KAAK,EAAC,MAAX;AAAA,gCACC;AAAO,UAAA,IAAI,EAAC,MAAZ;AAAmB,UAAA,QAAQ,EAAE,KAAKnC;AAAlC;AAAA;AAAA;AAAA;AAAA,gBADD,EAEEqC,aAFF;AAAA;AAAA;AAAA;AAAA;AAAA,cAVD,eAcC;AAAQ,QAAA,OAAO,EAAE,KAAKlC,SAAtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAdD;AAAA;AAAA;AAAA;AAAA;AAAA,YADD;AAkBA;;AAtH8C","sourcesContent":["import './style.scss';\r\nimport React from 'react';\r\nimport Cookies from 'js-cookie';\r\n\r\nexport class CreatePost extends React.Component {\r\n\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.state = {\r\n\t\t\tpasteles: [],\r\n\t\t\tfile: '',\r\n\t\t\timagePreviewUrl: '',\r\n\t\t\toption: ''\r\n\t\t};\r\n\r\n\t\tthis.handleImageChange = this.handleImageChange.bind(this);\r\n\t\tthis.handleSelect = this.handleSelect.bind(this);\r\n\t\tthis.crearPost = this.crearPost.bind(this);\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\tthis.getCakes();\r\n\t}\r\n\r\n\tcrearPost(e) {\r\n\t\tlet form_data = new FormData()\r\n\t\tform_data.append('foto', this.state.file)\r\n\t\tform_data.append('likes', 0)\r\n\t\tform_data.append('status', true)\r\n\t\tform_data.append('reported', false)\r\n\t\tform_data.append('pastel', this.state.option)\r\n\r\n\t\tconst requestOptions = {\r\n            method: 'POST',\r\n            headers: { \r\n\t\t\t\t'X-CSRFToken':Cookies.get('csrftoken')\r\n\t\t\t},\r\n            credentials: \"include\",\r\n            body: form_data\r\n        };\r\n\r\n\t\tfetch('http://localhost:8000/social/create_post/', requestOptions)\r\n        .then(res => res.json())\r\n        .then(json => {\r\n\t\t\tthis.props.update()\r\n\t\t\tconsole.log('Post creado\\n' + json)\r\n        })\r\n        .catch(error => console.log(error))   \r\n\t}\r\n\r\n\thandleSelect(e) {\r\n\t\tconsole.log(e)\r\n        this.setState({\r\n            option: e.target.value,\r\n        })\r\n    }\r\n\r\n\thandleImageChange(e) {\r\n\t\te.preventDefault();\r\n\r\n\t\tlet reader = new FileReader();\r\n\t\tlet file = e.target.files[0];\r\n\r\n\t\treader.onloadend = () => {\r\n\t\t\tthis.setState({\r\n\t\t\t\tfile: file,\r\n\t\t\t\timagePreviewUrl: reader.result,\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treader.readAsDataURL(file)\r\n\t}\r\n\r\n\tgetCakes() {\r\n\t\tconst requestOptions = {\r\n\t\t\tmethod: 'GET',\r\n\t\t\theaders: {\r\n\t\t\t\t'Content-Type': 'application/json',\r\n\t\t\t\t'X-CSRFToken': Cookies.get('csrftoken')\r\n\t\t\t},\r\n\t\t\tcredentials: \"include\"\r\n\t\t};\r\n\r\n\t\tfetch('http://localhost:8000/pasteles/', requestOptions)\r\n\t\t\t.then(res => res.json())\r\n\t\t\t.then(json => {\r\n\t\t\t\tthis.setState({\r\n\t\t\t\t\tpasteles: json,\r\n\t\t\t\t\toption: json[0].id\r\n\t\t\t\t});\r\n\t\t\t})\r\n\t\t\t.catch(error => console.log(error))\r\n\t}\r\n\r\n\trender() {\r\n\r\n\t\tlet { imagePreviewUrl } = this.state;\r\n\t\tlet $imagePreview = null;\r\n\t\tif (imagePreviewUrl) {\r\n\t\t\t$imagePreview = (<img src={imagePreviewUrl} />);\r\n\t\t} else {\r\n\t\t\t$imagePreview = (<div className=\"previewText\">Elige una imagen para el post</div>);\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t<div className=\"container\">\r\n\t\t\t\t<label>Crear Post</label><br />\r\n\t\t\t\t<label>pastel: </label>\r\n\t\t\t\t<select value={this.state.option} onChange = {this.handleSelect}>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.state.pasteles.map(pastel =>\r\n\t\t\t\t\t\t\t<option value={pastel.id}>{pastel.id}</option>\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t}\r\n\t\t\t\t</select>\r\n\t\t\t\t<div class=\"foto\">\r\n\t\t\t\t\t<input type=\"file\" onChange={this.handleImageChange} />\r\n\t\t\t\t\t{$imagePreview}\r\n\t\t\t\t</div>\r\n\t\t\t\t<button onClick={this.crearPost}>crear</button>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}"]},"metadata":{},"sourceType":"module"}