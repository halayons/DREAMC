{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\joha\\\\Desktop\\\\dcake1\\\\DreamCakeFront\\\\src\\\\components\\\\social\\\\createPost.jsx\";\nimport './style.scss';\nimport foto from '../../static/images/foto1.png';\nimport React from 'react';\nimport Cookies from 'js-cookie';\nimport { Pastel, PastelC } from '../Pedidos/Pedidos';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport class CreatePost extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      pasteles: [],\n      file: '',\n      imagePreviewUrl: '',\n      option: '',\n      cakePaint: undefined\n    };\n    this.handleImageChange = this.handleImageChange.bind(this);\n    this.handleSelect = this.handleSelect.bind(this);\n    this.crearPost = this.crearPost.bind(this);\n  }\n\n  componentDidMount() {\n    this.getCakes();\n  }\n\n  crearPost(e) {\n    let form_data = new FormData();\n    form_data.append('foto', this.state.file);\n    form_data.append('likes', 0);\n    form_data.append('status', true);\n    form_data.append('reported', false);\n    form_data.append('pastel', this.state.option);\n    const requestOptions = {\n      method: 'POST',\n      headers: {\n        'X-CSRFToken': Cookies.get('csrftoken')\n      },\n      credentials: \"include\",\n      body: form_data\n    };\n    fetch('http://localhost:8000/social/create_post/', requestOptions).then(res => res.json()).then(json => {\n      this.props.update();\n      console.log('Post creado\\n' + json);\n    }).catch(error => console.log(error));\n    let activar = document.getElementById('post-collapse');\n    activar.hidden = true;\n  }\n\n  handleSelect(e) {\n    let i = e.target.value;\n    this.setState({\n      cakePaint: this.state.pasteles[i],\n      option: i\n    });\n    let activar = document.getElementById('post-collapse');\n    activar.hidden = false;\n  }\n\n  handleImageChange(e) {\n    e.preventDefault();\n    let reader = new FileReader();\n    let file = e.target.files[0];\n\n    reader.onloadend = () => {\n      this.setState({\n        file: file,\n        imagePreviewUrl: reader.result\n      });\n    };\n\n    reader.readAsDataURL(file);\n    let activar = document.getElementById('post-collapse');\n    activar.hidden = false;\n  }\n\n  getCakes() {\n    const requestOptions = {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json',\n        'X-CSRFToken': Cookies.get('csrftoken')\n      },\n      credentials: \"include\"\n    };\n    fetch('http://localhost:8000/pasteles/', requestOptions).then(res => res.json()).then(json => {\n      this.setState({\n        pasteles: json\n      });\n    }).catch(error => console.log(error));\n  }\n\n  paintCakes(p) {\n    //masa[CH,VA,TL,RV]\n    //relleno[AQ,NU,ML,CP]\n    let masa = ['url(\"https://www.transparenttextures.com/patterns/45-degree-fabric-dark.png\")', 'url(\"https://www.transparenttextures.com/patterns/asfalt-dark.png\")', 'url(\"https://www.transparenttextures.com/patterns/ravenna.png\")', 'url(\"https://www.transparenttextures.com/patterns/crisp-paper-ruffles.png\")'];\n    let relleno = [\"#995c2e\", \"#69391d\", \"#5c0c15b5\", \"#e4cc8ba1\"];\n    if (p.masa == 'CH') masa = masa[0];\n    if (p.masa == 'VA') masa = masa[1];\n    if (p.masa == 'TL') masa = masa[2];\n    if (p.masa == 'RV') masa = masa[3];\n    if (p.relleno == 'AQ') relleno = relleno[0];\n    if (p.relleno == 'NU') relleno = relleno[1];\n    if (p.relleno == 'ML') relleno = relleno[2];\n    if (p.relleno == 'CP') relleno = relleno[3];\n    document.documentElement.style.setProperty('--color-pastel2', relleno);\n    document.documentElement.style.setProperty('--textura-pastel', masa);\n\n    if (p.cobertura == 'FD') {\n      document.documentElement.style.setProperty('--color-pastel', p.color);\n      document.documentElement.style.setProperty('--textura-pastel2', '');\n    }\n\n    if (p.cobertura == 'CR') {\n      document.documentElement.style.setProperty('--color-pastel', '#eee8c9');\n      document.documentElement.style.setProperty('--textura-pastel2', \"url(http://www.transparenttextures.com/patterns/zig-zag.png)\");\n    }\n\n    return p.forma == 'CI' ? /*#__PURE__*/_jsxDEV(Pastel, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 19\n    }, this) : /*#__PURE__*/_jsxDEV(PastelC, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 39\n    }, this);\n  }\n\n  countCakes(p) {\n    return p.map(e => /*#__PURE__*/_jsxDEV(\"option\", {\n      type: \"bottom\",\n      children: p.indexOf(e)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 13\n    }, this));\n  }\n\n  render() {\n    let {\n      imagePreviewUrl\n    } = this.state;\n    let $imagePreview = null;\n\n    if (imagePreviewUrl) {\n      $imagePreview = /*#__PURE__*/_jsxDEV(\"img\", {\n        className: \"img-fluid shadow-lg img-post \",\n        style: {\n          margin: \"auto\"\n        },\n        src: imagePreviewUrl\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 148,\n        columnNumber: 21\n      }, this);\n    }\n\n    if (this.state.pasteles.length > 0) {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"container crearPost\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"form-row justify-content-center\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"bg-light\",\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              id: \"imgfile\",\n              type: \"file\",\n              onChange: this.handleImageChange\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 159,\n              columnNumber: 8\n            }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n              htmlFor: \"imgfile\",\n              className: \"btn btn-outline-info\",\n              children: [/*#__PURE__*/_jsxDEV(\"img\", {\n                className: \"foto\",\n                src: foto\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 161,\n                columnNumber: 9\n              }, this), \"Escoger foto\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 160,\n              columnNumber: 8\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 158,\n            columnNumber: 7\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"col-lg-2 col-sm-2 col-2\",\n            children: /*#__PURE__*/_jsxDEV(\"select\", {\n              className: \"form-control \",\n              id: \"pastelID\",\n              value: this.state.option,\n              placeholder: \"h\",\n              onChange: this.handleSelect,\n              children: this.countCakes(this.state.pasteles)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 167,\n              columnNumber: 10\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 165,\n            columnNumber: 7\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 157,\n          columnNumber: 6\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"row justify-content-left postearImg crearPost\",\n          hidden: \"true\",\n          id: \"post-collapse\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \" col-lg-3 col-sm-5 col-12 \",\n            children: $imagePreview\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 180,\n            columnNumber: 8\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \" col-lg-5 col-sm-7 col-12\",\n            children: this.state.cakePaint != undefined ? this.paintCakes(this.state.cakePaint) : ''\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 183,\n            columnNumber: 8\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"form-control badge badge-info\",\n            type: \"button\",\n            onClick: this.crearPost,\n            children: \"Post\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 188,\n            columnNumber: 8\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 178,\n          columnNumber: 6\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 156,\n        columnNumber: 5\n      }, this);\n    } else {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"badge badge-primary\",\n          onClick: this.getCakes,\n          children: \"RECARGAR\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 194,\n          columnNumber: 4\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 192,\n        columnNumber: 16\n      }, this);\n    }\n  }\n\n}","map":{"version":3,"sources":["C:/Users/joha/Desktop/dcake1/DreamCakeFront/src/components/social/createPost.jsx"],"names":["foto","React","Cookies","Pastel","PastelC","CreatePost","Component","constructor","props","state","pasteles","file","imagePreviewUrl","option","cakePaint","undefined","handleImageChange","bind","handleSelect","crearPost","componentDidMount","getCakes","e","form_data","FormData","append","requestOptions","method","headers","get","credentials","body","fetch","then","res","json","update","console","log","catch","error","activar","document","getElementById","hidden","i","target","value","setState","preventDefault","reader","FileReader","files","onloadend","result","readAsDataURL","paintCakes","p","masa","relleno","documentElement","style","setProperty","cobertura","color","forma","countCakes","map","indexOf","render","$imagePreview","margin","length"],"mappings":"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","sourcesContent":["import './style.scss';\r\nimport foto from '../../static/images/foto1.png';\r\nimport React from 'react';\r\nimport Cookies from 'js-cookie';\r\nimport {Pastel,PastelC} from '../Pedidos/Pedidos'\r\n\r\nexport class CreatePost extends React.Component {\r\n\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.state = {\r\n\t\t\tpasteles: [],\r\n\t\t\tfile: '',\r\n\t\t\timagePreviewUrl: '',\r\n\t\t\toption: '',\r\n\t\t\tcakePaint:undefined\r\n\t\t};\r\n\r\n\t\tthis.handleImageChange = this.handleImageChange.bind(this);\r\n\t\tthis.handleSelect = this.handleSelect.bind(this);\r\n\t\tthis.crearPost = this.crearPost.bind(this);\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\tthis.getCakes();\r\n\t}\r\n\r\n\tcrearPost(e) {\r\n\t\tlet form_data = new FormData()\r\n\t\tform_data.append('foto', this.state.file)\r\n\t\tform_data.append('likes', 0)\r\n\t\tform_data.append('status', true)\r\n\t\tform_data.append('reported', false)\r\n\t\tform_data.append('pastel', this.state.option)\r\n\r\n\t\tconst requestOptions = {\r\n            method: 'POST',\r\n            headers: { \r\n\t\t\t\t'X-CSRFToken':Cookies.get('csrftoken')\r\n\t\t\t},\r\n            credentials: \"include\",\r\n            body: form_data\r\n        };\r\n\r\n\t\tfetch('http://localhost:8000/social/create_post/', requestOptions)\r\n        .then(res => res.json())\r\n        .then(json => {\r\n\t\t\tthis.props.update()\r\n\t\t\tconsole.log('Post creado\\n' + json)\r\n        })\r\n        .catch(error => console.log(error))   \r\n\r\n\t\tlet activar = document.getElementById('post-collapse');\r\n\t\tactivar.hidden=true\r\n\t}\r\n\r\n\thandleSelect(e) {\r\n\t\tlet i =e.target.value;\r\n        this.setState({\r\n            cakePaint: this.state.pasteles[i],\r\n\t\t\toption:i\r\n        })\r\n\t\tlet activar = document.getElementById('post-collapse');\r\n\t\tactivar.hidden=false\r\n    }\r\n\r\n\thandleImageChange(e) {\r\n\t\te.preventDefault();\r\n\r\n\t\tlet reader = new FileReader();\r\n\t\tlet file = e.target.files[0];\r\n\r\n\t\treader.onloadend = () => {\r\n\t\t\tthis.setState({\r\n\t\t\t\tfile: file,\r\n\t\t\t\timagePreviewUrl: reader.result,\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treader.readAsDataURL(file)\r\n\t\tlet activar = document.getElementById('post-collapse');\r\n\t\tactivar.hidden=false;\r\n\t}\r\n\r\n\tgetCakes() {\r\n\t\t\r\n\t\tconst requestOptions = {\r\n\t\t\tmethod: 'GET',\r\n\t\t\theaders: {\r\n\t\t\t\t'Content-Type': 'application/json',\r\n\t\t\t\t'X-CSRFToken': Cookies.get('csrftoken')\r\n\t\t\t},\r\n\t\t\tcredentials: \"include\"\r\n\t\t};\r\n\r\n\t\tfetch('http://localhost:8000/pasteles/', requestOptions)\r\n\t\t\t.then(res => res.json())\r\n\t\t\t.then(json => {\r\n\t\t\t\tthis.setState({\r\n\t\t\t\t\tpasteles: json\r\n\t\t\t\t});\r\n\t\t\t})\r\n\t\t\t.catch(error => console.log(error))\r\n\t}\r\n\t\r\n\tpaintCakes(p){\r\n\t\t\r\n\t\t//masa[CH,VA,TL,RV]\r\n\t\t//relleno[AQ,NU,ML,CP]\r\n\t\tlet masa=['url(\"https://www.transparenttextures.com/patterns/45-degree-fabric-dark.png\")', 'url(\"https://www.transparenttextures.com/patterns/asfalt-dark.png\")','url(\"https://www.transparenttextures.com/patterns/ravenna.png\")','url(\"https://www.transparenttextures.com/patterns/crisp-paper-ruffles.png\")']\r\n\t\tlet relleno=[\"#995c2e\",\"#69391d\",\"#5c0c15b5\", \"#e4cc8ba1\"]\r\n\r\n\t\tif(p.masa=='CH') masa=masa[0]\r\n\t\tif(p.masa=='VA') masa=masa[1]\r\n\t\tif(p.masa=='TL') masa=masa[2]\r\n\t\tif(p.masa=='RV') masa=masa[3]\r\n\t\t\r\n\t\tif(p.relleno=='AQ') relleno=relleno[0]\r\n\t\tif(p.relleno=='NU') relleno=relleno[1]\r\n\t\tif(p.relleno=='ML') relleno=relleno[2]\r\n\t\tif(p.relleno=='CP') relleno=relleno[3]\r\n\r\n\t\t\r\n        document.documentElement.style.setProperty('--color-pastel2',relleno);\r\n\t\tdocument.documentElement.style.setProperty('--textura-pastel',masa);\r\n\r\n\t\tif(p.cobertura =='FD') { \r\n\t\t\tdocument.documentElement.style.setProperty('--color-pastel',p.color);\r\n\t\t\tdocument.documentElement.style.setProperty('--textura-pastel2','');}\r\n\t\tif(p.cobertura=='CR') {\r\n\t\t\tdocument.documentElement.style.setProperty('--color-pastel','#eee8c9');\r\n\t\t\tdocument.documentElement.style.setProperty('--textura-pastel2',\"url(http://www.transparenttextures.com/patterns/zig-zag.png)\");}\r\n\t\t\r\n\t\treturn(\r\n\t\t\tp.forma=='CI'?(<Pastel></Pastel>):(<PastelC></PastelC>)\r\n\t\t);\r\n\t}\r\n\tcountCakes(p){\r\n\t\treturn(\r\n\t\t\tp.map(e=><option type=\"bottom\" >{p.indexOf(e)}</option>)\r\n\t\t)\r\n\t}\r\n\trender() {\r\n\t\t\r\n\t\tlet { imagePreviewUrl } = this.state;\r\n\t\tlet $imagePreview = null;\r\n\t\tif (imagePreviewUrl) {\r\n\t\t\t$imagePreview = (<img className =\"img-fluid shadow-lg img-post \" style ={{margin:\"auto\"}} src={imagePreviewUrl} />);\r\n\t\t}\r\n\r\n\r\n\r\n\t\tif(this.state.pasteles.length>0){\r\n\t\t\t\r\n\t\t\treturn (\r\n\t\t\t\t<div className=\"container crearPost\">\r\n\t\t\t\t\t<div className=\"form-row justify-content-center\">\r\n\t\t\t\t\t\t<div className=\"bg-light\">\r\n\t\t\t\t\t\t\t<input  id =\"imgfile\" type=\"file\" onChange={this.handleImageChange} />\r\n\t\t\t\t\t\t\t<label htmlFor=\"imgfile\" className=\"btn btn-outline-info\">\r\n\t\t\t\t\t\t\t\t<img className=\"foto\" src={foto}/>\r\n\t\t\t\t\t\t\t\tEscoger foto\r\n\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"col-lg-2 col-sm-2 col-2\">\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t<select className=\"form-control \" id=\"pastelID\" value={this.state.option} placeholder=\"h\" onChange = {this.handleSelect}>\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t{\t\r\n\t\t\t\t\t\t\t\t\t\t\tthis.countCakes(this.state.pasteles)\r\n\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t</select>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"row justify-content-left postearImg crearPost\" hidden='true'  id=\"post-collapse\">\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t<div className =\" col-lg-3 col-sm-5 col-12 \">\r\n\t\t\t\t\t\t\t\t{$imagePreview}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div className =\" col-lg-5 col-sm-7 col-12\">\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tthis.state.cakePaint!=undefined ?(this.paintCakes(this.state.cakePaint)):('')\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<button className=\"form-control badge badge-info\" type=\"button\"  onClick={this.crearPost}>Post</button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t);\r\n\t\t}else{return <div>\r\n\t\t\t\r\n\t\t\t<button className=\"badge badge-primary\" onClick={this.getCakes}>RECARGAR</button>\r\n\t\t</div>}\r\n\t}\r\n}"]},"metadata":{},"sourceType":"module"}