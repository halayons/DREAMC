{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\joha\\\\Desktop\\\\dcake1\\\\DreamCakeFront\\\\src\\\\components\\\\social\\\\social.jsx\";\nimport './style.scss';\nimport React from 'react';\nimport { Feed } from './feed';\nimport { CreatePost } from './createPost';\nimport { Footer, Header } from '../landingPage';\nimport Cookies from 'js-cookie';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport class Social extends React.Component {\n  constructor() {\n    super();\n    this.ws = new WebSocket(\"ws://localhost:8000/ws/socialGeneral/\");\n    this.attrs = {\n      1: \"likes\",\n      2: \"published_date\"\n    };\n    this.order = {\n      asc: \"\",\n      desc: \"-\"\n    };\n    this.state = {\n      attr: this.attrs[2],\n      count: 20,\n      order: this.order.desc,\n      posts: []\n    };\n    this.update = this.update.bind(this);\n  }\n\n  componentDidMount() {\n    this.requestUser();\n    this.loadPosts();\n\n    this.ws.onopen = evt => this.send();\n\n    this.ws.onclose = evt => window.location.reload();\n\n    this.ws.onmessage = evt => this.loadPosts();\n\n    this.ws.onerror = evt => console.log(JSON.stringify(evt));\n  }\n\n  requestUser() {\n    fetch('http://localhost:8000/users/api/auth/user/', {\n      method: 'GET',\n      credentials: 'include',\n      headers: {}\n    }).then(response => response.json()).then(responseJson => {\n      if (!responseJson.hasOwnProperty('email')) window.location.pathname = \"/\";\n    }).catch(error => window.location.pathname = \"/\");\n  }\n\n  loadPosts() {\n    const requestOptions = {\n      method: 'GET',\n      headers: {\n        // 'Content-Type': 'application/json',\n        'X-CSRFToken': Cookies.get('csrftoken')\n      },\n      credentials: \"include\"\n    };\n    fetch(\"http://localhost:8000/social/all_posts/\" + this.state.order + this.state.attr + \"/\" + this.state.count + \"/\", requestOptions).then(response => response.json()).then(json => this.setState({\n      posts: json\n    })).catch(error => console.log(error));\n  }\n\n  update() {\n    this.loadPosts();\n  }\n\n  send() {\n    this.ws.send(JSON.stringify({\n      type: \"subscribe\",\n      id: new Date().getTime(),\n      action: 'list',\n      model: \"social.Post\"\n    }));\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(CreatePost, {\n        update: this.update\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(Feed, {\n        posts: this.state.posts\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 5\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 4\n    }, this);\n  }\n\n}","map":{"version":3,"sources":["C:/Users/joha/Desktop/dcake1/DreamCakeFront/src/components/social/social.jsx"],"names":["React","Feed","CreatePost","Footer","Header","Cookies","Social","Component","constructor","ws","WebSocket","attrs","order","asc","desc","state","attr","count","posts","update","bind","componentDidMount","requestUser","loadPosts","onopen","evt","send","onclose","window","location","reload","onmessage","onerror","console","log","JSON","stringify","fetch","method","credentials","headers","then","response","json","responseJson","hasOwnProperty","pathname","catch","error","requestOptions","get","setState","type","id","Date","getTime","action","model","render"],"mappings":"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","sourcesContent":["import './style.scss';\r\nimport React from 'react';\r\nimport { Feed } from './feed';\r\nimport { CreatePost } from './createPost';\r\nimport { Footer, Header } from '../landingPage';\r\n\r\nimport Cookies from 'js-cookie';\r\n\r\n\r\nexport class Social extends React.Component {\r\n\r\n\tws = new WebSocket(\"ws://localhost:8000/ws/socialGeneral/\")\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\tthis.attrs = {\r\n\t\t\t1: \"likes\",\r\n\t\t\t2: \"published_date\",\r\n\t\t}\r\n\r\n\t\tthis.order = {\r\n\t\t\tasc: \"\",\r\n\t\t\tdesc: \"-\"\r\n\t\t}\r\n\r\n\t\tthis.state = {\r\n\t\t\tattr: this.attrs[2],\r\n\t\t\tcount: 20,\r\n\t\t\torder: this.order.desc,\r\n\t\t\tposts: []\r\n\t\t};\r\n\r\n\t\tthis.update = this.update.bind(this)\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\tthis.requestUser()\r\n\t\tthis.loadPosts()\r\n\r\n\t\tthis.ws.onopen = evt => this.send();\r\n\t\tthis.ws.onclose = evt => window.location.reload();\r\n\t\tthis.ws.onmessage = evt => this.loadPosts();\r\n\t\tthis.ws.onerror = evt => console.log(JSON.stringify(evt));\r\n\t}\r\n\r\n\trequestUser() {\r\n\t\tfetch('http://localhost:8000/users/api/auth/user/', {\r\n\t\t\tmethod: 'GET',\r\n\t\t\tcredentials: 'include',\r\n\t\t\theaders: {\r\n\t\t\t},\r\n\t\t}).then((response) => response.json())\r\n\t\t\t.then(responseJson => {\r\n\t\t\t\tif(!responseJson.hasOwnProperty('email')) window.location.pathname = \"/\";\r\n\t\t\t}).catch(error => window.location.pathname = \"/\");\r\n\t}\r\n\r\n\r\n\tloadPosts() {\r\n\t\tconst requestOptions = {\r\n\t\t\tmethod: 'GET',\r\n\t\t\theaders: {\r\n\t\t\t\t// 'Content-Type': 'application/json',\r\n\t\t\t\t'X-CSRFToken': Cookies.get('csrftoken')\r\n\t\t\t},\r\n\t\t\tcredentials: \"include\",\r\n\t\t};\r\n\t\tfetch(\"http://localhost:8000/social/all_posts/\" + this.state.order + this.state.attr + \"/\" + this.state.count + \"/\", requestOptions)\r\n\t\t\t.then(response => response.json())\r\n\t\t\t.then(json => this.setState({\r\n\t\t\t\tposts: json\r\n\t\t\t}))\r\n\t\t\t.catch(error => console.log(error));\r\n\t}\r\n\r\n\tupdate() {\r\n\t\tthis.loadPosts()\r\n\t}\r\n\r\n\tsend() {\r\n\t\tthis.ws.send(JSON.stringify({\r\n\t\t\ttype: \"subscribe\",\r\n\t\t\tid: new Date().getTime(),\r\n\t\t\taction: 'list',\r\n\t\t\tmodel: \"social.Post\"\r\n\t\t}))\r\n\t}\r\n\r\n\trender() {\r\n\r\n\t\treturn (\r\n\t\t\t<div>\r\n\t\t\t\t<CreatePost update={this.update} />\r\n\t\t\t\t<Feed posts={this.state.posts} />\r\n\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}"]},"metadata":{},"sourceType":"module"}